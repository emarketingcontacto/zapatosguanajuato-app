let divHeart;const currentUrl=window.location.origin;function checkLikes(e){divHeart="SPAN"==e.target.tagName?e.target.parentNode:e.target;let t=divHeart.dataset.bizid,i=divHeart.dataset.userid,a=divHeart.dataset.likeid;0==divHeart.dataset.userlikeit?createLike(t,i):deleteLike(a)}async function createLike(e,t){try{let i=await fetch(currentUrl+"/api/v1/likes/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bizId:e,userId:t})}),a=await i.json();console.log("Success:",a),usingDataCreated(a)}catch(r){console.error("Error",r)}}function usingDataCreated(e){let t=Object.values(e);t.forEach(e=>{divHeart.setAttribute("data-likeid",e.likeId),divHeart.setAttribute("data-userlikeit",1);let t=divHeart.querySelector("#heart");t.style.color="red",addLikes()})}async function deleteLike(e){await fetch(currentUrl+"/api/v1/likes/"+e,{method:"DELETE",headers:{"Content-Type":"application/json"}}).then(e=>{if(!e.ok)throw Error("Not succesful")}).catch(e=>console.log(e)),usingDataDeleted("Deleted")}function usingDataDeleted(e){if("Deleted"===e){let t=divHeart.querySelector("#heart");t.style.color="#cecece",divHeart.setAttribute("data-likeId",0),divHeart.setAttribute("data-userlikeit",0),subsLikes()}}function addLikes(){let e=divHeart.querySelector("#countLikes"),t=e.innerHTML,i=parseInt(t=t.substring(1,t.length-1))+1;e.innerHTML="("+i+")"}function subsLikes(){let e=divHeart.querySelector("#countLikes"),t=e.innerHTML,i=parseInt(t=t.substring(1,t.length-1))-1;e.innerHTML="("+i+")"}
